import{r as h,c as u,h as a,H as m,g}from"./preview-BLkU8-7b.js";import{g as c}from"./index-2dc281eb-DCayfYZh.js";import"./jsx-runtime-qGIIFXMu.js";import"./index-CDs2tPxN.js";import"./iframe-BYgjunmg.js";import"../sb-preview/runtime.js";import"./tslib.es6-pJfR_DrR.js";const p=(e,l=2)=>{if(!Number(e))return"0 bytes";const d=1024,i=l<0?0:l,o=["bytes","kB","MB","GB","TB"],s=Math.floor(Math.log(e)/Math.log(d));return`${Number.parseFloat((e/Math.pow(d,s)).toFixed(i))} ${o[s]}`},v=`:host,::slotted(*),*{box-sizing:border-box}:host([disabled]){cursor:not-allowed !important;}:host([disabled]) *,:host([disabled]) ::slotted(*){cursor:not-allowed !important;pointer-events:none !important;}button,.market-button,::slotted(button),::slotted(.market-button),::slotted(.market-link){font-weight:var(--core-type-semibold-30-weight);font-size:var(--core-type-semibold-30-size);font-family:var(--core-type-semibold-30-font-family);line-height:var(--core-type-semibold-30-leading);letter-spacing:var(--core-type-semibold-30-tracking);text-transform:var(--core-type-semibold-30-case)}.label-container{border-width:var(--file-upload-border-width, 1px);border-style:var(--file-upload-normal-state-border-style, dashed);border-color:var(--file-upload-normal-state-border-color, var(--core-fill-30-color));border-radius:var(--file-upload-border-radius, 6px);transition:background-color border-color 0.2s}.label-container>label{display:flex;flex-direction:column;justify-content:center;align-items:center;padding:var(--file-upload-dropzone-vertical-padding, var(--core-metrics-spacing-400))
      var(--file-upload-dropzone-horizontal-padding, var(--core-metrics-spacing-400));text-align:center;cursor:pointer}.label-container>label .market-icon{color:var(--file-upload-label-fill-color, var(--core-text-10-color))}.label-container>.market-row{margin:0}button,.market-button,::slotted(button),::slotted(.market-button),::slotted(.market-link){padding:0;border:none;background-color:inherit;color:var(--file-upload-button-label-color, var(--button-normal-variant-tertiary-rank-normal-state-label-color));font-family:inherit;text-align:right;cursor:pointer}.has-file-selected{border-style:var(--file-upload-file-selected-state-border-style, solid) !important;border-color:var(--file-upload-file-selected-state-border-color, var(--core-fill-30-color))}@media (hover: hover){:host(:hover) .label-container{border-style:var(--file-upload-hover-state-border-style, dashed);border-color:var(--file-upload-hover-state-border-color, var(--core-emphasis-fill-color));background-color:var(--file-upload-hover-state-background-color, var(--core-emphasis-40-color))}}:host(:active) .label-container,:host(:active) .is-dragging-over{border-style:var(--file-upload-active-state-border-style, dashed);border-color:var(--file-upload-active-state-border-color, var(--core-emphasis-fill-color));background-color:var(--file-upload-active-state-background-color, var(--core-emphasis-30-color))}:host([disabled]) .label-container{border-style:var(--file-upload-disabled-state-border-style, dashed);border-color:var(--file-upload-disabled-state-border-color, var(--field-disabled-state-border-color));background-color:var(--file-upload-disabled-state-background-color, var(--field-disabled-state-background-color));color:var(--file-upload-disabled-state-label-color, var(--field-disabled-state-empty-phase-label-color))}:host([disabled]) button,:host([disabled]) ::slotted(button),:host([disabled]) ::slotted(.market-button),:host([disabled]) ::slotted(.market-icon),:host([disabled]) ::slotted(.market-link),:host([disabled]) label .market-icon,:host([disabled]) label ::slotted(.market-icon){opacity:30%}.market-list{margin-top:var(--file-upload-dropzone-vertical-margin, var(--core-metrics-spacing-100))}.market-accessory[slot="leading-accessory"]{border-radius:var(--file-upload-border-radius, 6px);background-color:var(--file-upload-leading-accessory-background-color, var(--core-fill-40-color))}.market-accessory[slot="trailing-accessory"]{cursor:pointer}.market-accessory[slot="trailing-accessory"] .market-icon{color:var(--file-upload-delete-fill-color, var(--core-fill-20-color))}[data-status]:not([data-status=""]) .market-accessory[slot="leading-accessory"]{background-color:unset}[data-status="error"] [slot="subtext"],[data-status="error"] .market-accessory[slot="leading-accessory"]{color:var(--file-upload-leading-accessory-error-color, var(--core-critical-fill-color))}:host([disabled]) [data-status="error"] [slot="subtext"]{opacity:30%}[data-status="success"] .market-accessory[slot="leading-accessory"]{color:var(--file-upload-leading-accessory-success-color, var(--core-success-fill-color))}[data-status="loading"] .market-accessory[slot="leading-accessory"]{animation:market-file-upload-loading-rotation 1s infinite linear}@keyframes market-file-upload-loading-rotation{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host([invalid]) .label-container{border-color:var(--field-normal-state-invalid-validity-border-color)}::slotted([slot="bottom-accessory"]){color:var(--core-text-20-color)}`,k=v,y=class{constructor(e){h(this,e),this.marketFileUploadValueChange=u(this,"marketFileUploadValueChange",7),this.accept="",this.value=[],this.disabled=!1,this.invalid=!1,this.multiple=!1,this.fileSubtext=void 0,this.fileMetadata=void 0,this.deleteButtonAriaLabel="Delete",this.isDraggingOver=!1,this.files=void 0}watchValueHandler(e){Array.isArray(e)&&(this.files=this.multiple?[...e]:[e[0]])}get hasSingleFileSelected(){return!this.multiple&&this.files.length===1}draggingOver(e){this.disabled||this.hasSingleFileSelected||(this.isDraggingOver=!0,e.preventDefault())}endDrag(e){e.preventDefault(),!(this.disabled||this.hasSingleFileSelected)&&(this.isDraggingOver=!1,e.type==="drop"&&e.dataTransfer&&this.addFiles(e.dataTransfer.files))}handleButtonClick(){this.fileInputElement.click()}handleDeleteKeydown(e,l){e.key==="Enter"&&!this.disabled&&this.removeFile(l)}removeFile(e){this.files.splice(e,1),this.files=[...this.files],this.emitFileChange()}labelContainerClassNames(){const e=[];return this.isDraggingOver&&e.push("is-dragging-over"),this.hasSingleFileSelected&&e.push("has-file-selected"),e}onInputChange(e){this.addFiles(e.target.files),this.fileInputElement.value=""}addFiles(e){e&&(this.multiple?this.files=[...e,...this.files]:this.files=[e[0]]),this.emitFileChange()}emitFileChange(){this.marketFileUploadValueChange.emit({value:this.files})}componentWillLoad(){this.value?this.files=[...this.value]:this.files=[]}renderFilesAsMarketRows(){const e=c("market-row"),l=c("market-accessory"),d=c("market-icon");return this.files.map((i,o)=>{var s;const r=(s=this.fileMetadata)===null||s===void 0?void 0:s.find(f=>f.filename===i.name);let t=i.type.startsWith("image/")?"picture":"file",b="delete",n;switch(this.fileSubtext){case"size":n=p(i[this.fileSubtext]);break;case"type":n=i[this.fileSubtext];break}switch(r==null?void 0:r.status){case"error":t="warning",b="clear",n=r==null?void 0:r.message;break;case"loading":t="loading",b="clear";break;case"success":t="success";break}return t=(r==null?void 0:r.leadingIconName)||t,a(e,{disabled:this.disabled,interactive:!0,transient:!0,"data-index":o,"data-status":r==null?void 0:r.status},a("label",{slot:"label"},i.name),n&&a("p",{slot:"subtext"},n),a(l,{slot:"leading-accessory",size:"image"},a(d,{name:t,fidelity:24})),a(l,{slot:"trailing-accessory",size:"icon",tabindex:this.disabled?-1:0,role:"button","aria-label":this.deleteButtonAriaLabel,onKeyDown:f=>this.handleDeleteKeydown(f,o),onClick:()=>this.removeFile(o)},a(d,{name:b,fidelity:24})))})}render(){const e=c("market-list"),l=c("market-accessory"),d=c("market-icon"),i=c("market-field"),o=this.renderFilesAsMarketRows(),s=this.multiple||o.length===0,r=this.multiple&&o.length>0;return a(m,{key:"99154cb30ba14f668d422360d2f897f1eeb0ef5b",class:"market-file-upload",ondragenter:t=>this.draggingOver(t),ondragover:t=>this.draggingOver(t),ondragleave:t=>this.endDrag(t),ondrop:t=>this.endDrag(t)},a(i,{key:"eb29b832ad87ba0ed349826d289844ab3654dd98",disabled:this.disabled,invalid:this.invalid},a("div",{key:"34ebdb3e0dd96eccf2819e6c9cfbeca56a0fcb26",class:`label-container ${this.labelContainerClassNames()}`},!s&&o[0],s&&a("label",{key:"e7071b6cfac5caab8adc3aa68695e3a4ffcf4a37"},a("slot",{key:"a4ebfa4bffff60705e9d787058228d6f27448c0b"},a(l,{key:"52058418915eefd90b8ee5a13334ca2e1bfd487a",size:"image"},a(d,{key:"b1ee0be0de7f21732c6c155b1109b28389d73aa5",name:"file",fidelity:24})),a("span",{key:"1483535663751c5fedce9a52f7059cdc1732950c"},a("button",{key:"7634bbaa55feeb182ca404778265f063c09e6e6c",onClick:()=>this.handleButtonClick()},"Choose a file")," or drag and drop it here")),a("input",{key:"5610de82688ad1fbcb7bcf5de1657490421b5460",ref:t=>this.fileInputElement=t,onChange:t=>this.onInputChange(t),type:"file",name:"files[]",multiple:this.multiple,accept:this.accept,hidden:!0}))),a("slot",{key:"641a691d00689541f0d6df282da56b9968bc01d4",name:"bottom-accessory"},a("small",{key:"146e18336d2ddc25d5be483b7d1d54a10c2ba95f",slot:"bottom-accessory"})),a("slot",{key:"66327afa937ac5ae013ec3aab1f2a61f99779786",name:"error"},a("small",{key:"e9a5328a31306a3bee459ab10a1b106d2962566e",slot:"error"}))),r&&a(e,{key:"8d69109a59d98afd7ea71732b8cef9bb3e082ecd",interactive:!0,transient:!0},o))}get el(){return g(this)}static get watchers(){return{value:["watchValueHandler"]}}};y.style=k;export{y as market_file_upload};
