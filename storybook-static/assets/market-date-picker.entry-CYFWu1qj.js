import{r as C,c as T,h as s,H as R,g as L}from"./preview-BLkU8-7b.js";import{M as d}from"./menu-48d7df69-CVnCCBlU.js";import{g as p}from"./index-2dc281eb-DCayfYZh.js";import{r as h,t as m,a as g,g as Y}from"./index-b9ae40c9-Bb5aO-kv.js";import{i as S,a as v,b}from"./index-61d35e8a-DYv6ppUq.js";import{v as H}from"./v4-fa4bb814-SoommWqA.js";import"./jsx-runtime-qGIIFXMu.js";import"./index-CDs2tPxN.js";import"./iframe-BYgjunmg.js";import"../sb-preview/runtime.js";import"./tslib.es6-pJfR_DrR.js";function x(a,e){h(2,arguments);var t=g(a),i=m(e);return isNaN(i)?new Date(NaN):(i&&t.setDate(t.getDate()+i),t)}function A(a,e){h(2,arguments);var t=g(a),i=m(e);if(isNaN(i))return new Date(NaN);if(!i)return t;var n=t.getDate(),r=new Date(t.getTime());r.setMonth(t.getMonth()+i+1,0);var o=r.getDate();return n>=o?r:(t.setFullYear(r.getFullYear(),r.getMonth(),n),t)}function k(a,e){var t,i,n,r,o,l,u,D;h(1,arguments);var c=Y(),y=m((t=(i=(n=(r=e==null?void 0:e.weekStartsOn)!==null&&r!==void 0?r:e==null||(o=e.locale)===null||o===void 0||(l=o.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&n!==void 0?n:c.weekStartsOn)!==null&&i!==void 0?i:(u=c.locale)===null||u===void 0||(D=u.options)===null||D===void 0?void 0:D.weekStartsOn)!==null&&t!==void 0?t:0);if(!(y>=0&&y<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=g(a),w=f.getDay(),N=(w<y?7:0)+w-y;return f.setDate(f.getDate()-N),f.setHours(0,0,0,0),f}function W(a,e){h(2,arguments);var t=m(e),i=t*7;return x(a,i)}function F(a,e){h(2,arguments);var t=m(e);return A(a,t*12)}function O(a){h(1,arguments);var e=g(a);return e.setDate(1),e.setHours(0,0,0,0),e}function _(a){h(1,arguments);var e=g(a),t=new Date(0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}function E(a,e){var t,i,n,r,o,l;h(1,arguments);var u=Y(),D=m((t=(i=(n=(r=void 0)!==null&&r!==void 0?r:void 0)!==null&&n!==void 0?n:u.weekStartsOn)!==null&&i!==void 0?i:(o=u.locale)===null||o===void 0||(l=o.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&t!==void 0?t:0);if(!(D>=0&&D<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var c=g(a),y=c.getDay(),f=(y<D?-7:0)+6-(y-D);return c.setDate(c.getDate()+f),c.setHours(23,59,59,999),c}function M(a){h(1,arguments);var e=g(a),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(0,0,0,0),e}function I(a){h(1,arguments);var e=g(a),t=e.getFullYear();return e.setFullYear(t+1,0,0),e.setHours(0,0,0,0),e}function P(){var a=new Date,e=a.getFullYear(),t=a.getMonth(),i=a.getDate(),n=new Date(0);return n.setFullYear(e,t,i-1),n.setHours(0,0,0,0),n}function V(a,e){h(2,arguments);var t=m(e);return A(a,-t)}function U(a,e){h(2,arguments);var t=m(e);return W(a,-t)}function K(a,e){h(2,arguments);var t=m(e);return F(a,-t)}const z=`:host{display:flex}@media only screen and (max-width: 800px){:host([mobile-menu-position="top"]){flex-direction:column}:host([mobile-menu-position="top"]) list-view{margin-bottom:var(--date-picker-menu-vertical-spacing)}:host([mobile-menu-position="bottom"]){flex-direction:column-reverse}:host([mobile-menu-position="bottom"]) list-view{margin-top:var(--date-picker-menu-vertical-spacing)}}header{height:var(--date-picker-header-minimum-height);margin-bottom:var(--date-picker-header-vertical-spacing)}nav{display:flex;justify-content:space-between;align-items:center}:host([year-view-active]) nav{justify-content:center}[id^="date-picker-label-"]{margin:0}.year-view-button{color:var(--date-picker-month-year-label-color, var(--core-text-10-color))}.year-view-button:hover,.year-view-button:active{background-color:transparent;color:var(--core-emphasis-text-color)}.caret{margin-left:var(--date-picker-header-button-padding)}:host([year-view-active]) .caret{transform:rotate(-180deg)}calendar{min-width:var(--date-picker-minimum-width)}month-view{display:grid;grid-template-rows:repeat(auto-fill, 1fr);grid-template-columns:repeat(7, 1fr);gap:var(--date-picker-grid-item-vertical-padding) var(--date-picker-grid-item-horizontal-padding);box-sizing:border-box}year-section{display:flex;gap:var(--date-picker-grid-item-year-button-vertical-padding, 0)
    var(--date-picker-grid-item-year-button-horizontal-padding, 12.5px);box-sizing:border-box}year-section .market-icon{width:var(--date-picker-grid-item-year-button-icon-size, var(--accessory-icon-variant-medium-size-height))}month-section{display:grid;grid-template-rows:repeat(3, 1fr);grid-template-columns:repeat(4, 1fr);gap:var(--date-picker-grid-item-month-button-vertical-padding, 16px)
    var(--date-picker-grid-item-month-button-horizontal-padding, 26.67px);box-sizing:border-box}`,$=z;class B{constructor(){this.date="",this.month=null,this.year=null,this.selected=!1,this.selection="none",this.today=!1,this.disabled=!1}}const X=class{constructor(a){C(this,a),this.marketDateRangeChanged=T(this,"marketDateRangeChanged",7),this.marketMenuSelectionChanged=T(this,"marketMenuSelectionChanged",7),this.yearViewMonthList=[],this.selectionType="single",this.selectedStartDate=void 0,this.selectedEndDate=void 0,this.presetMenuOption=void 0,this.displayMenu=!1,this.mobileMenuPosition="top",this.excludeMenuItems="",this.timeframe="present",this.isDateDisabled=void 0,this.locale=navigator.language||"en-US",this.displayedDate=void 0,this.withInputs="",this.invalid=!1,this.yearViewActive=!1,this.displayedMonth=void 0,this.displayedWeekdays=[],this.yearViewYearsList=[],this.hoveredDate=void 0}buildWeekdays(){this.displayedWeekdays=[];const a=k(new Date,{weekStartsOn:this.getLocaleFirstDayOfWeek()});let e;for(let t=0;t<7;t++)e=a.toLocaleDateString(this.locale,{weekday:"short"}),this.locale.startsWith("en-")&&(e=e.slice(0,-1)),this.displayedWeekdays.push(e),a.setDate(a.getDate()+1)}getLocaleFirstDayOfWeek(){var a,e,t,i,n;const r=new Intl.Locale(this.locale);return((n=(e=(a=r==null?void 0:r.weekInfo)===null||a===void 0?void 0:a.firstDay)!==null&&e!==void 0?e:(i=(t=r==null?void 0:r.getWeekInfo)===null||t===void 0?void 0:t.call(r))===null||i===void 0?void 0:i.firstDay)!==null&&n!==void 0?n:0)%7}addHoveredDateRangeStyling(a,e){if(!this.hoveredDate)return;const t=new Date(this.selectedStartDate);this.selectedStartDate&&!this.selectedEndDate&&S(a,this.hoveredDate)&&v(a,t)&&(e.selection="range-middle"),b(this.hoveredDate,a)&&(!this.selectedStartDate||this.selectedStartDate&&this.selectedEndDate||!v(this.hoveredDate,t)?e.selection="range-first":e.selection="range-last")}addDateSelectionAttributes(a,e,t,i){t&&b(e,t)&&(a.selected=!0,a.selection=this.selectionType==="single"?"single":"range-first"),this.selectionType==="range"&&(this.addHoveredDateRangeStyling(e,a),t&&i&&v(e,t)&&S(e,i)&&(a.selected=!0,a.selection="range-middle"),i&&b(e,i)&&(a.selected=!0,a.selection="range-last"))}buildCalendar(){const a=new Date,e=new Date(this.displayedDate),t=new Date(e.getFullYear(),e.getMonth(),1),i=this.getLocaleFirstDayOfWeek();t.getDay()===0&&i===1?t.setDate(t.getDate()-6):t.setDate(t.getDate()-(t.getDay()-i)),this.days=[];const n=this.selectedStartDate&&new Date(this.selectedStartDate),r=this.selectedEndDate&&new Date(this.selectedEndDate);for(let o=0;o<42;o++){const l=new B;if(l.year=t.getFullYear(),l.month=t.getMonth(),t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&(l.date=t.getDate().toString()),b(t,a)&&(l.today=!0),this.addDateSelectionAttributes(l,t,n,r),l.date&&this.isDateDisabled&&(l.disabled=this.isDateDisabled(t)),this.timeframe==="future"&&S(t,a)&&!b(t,a)&&(l.disabled=!0),this.timeframe==="past"&&v(t,a)&&!b(t,a)&&(l.disabled=!0),this.days.push(l),t.setDate(t.getDate()+1),t.getDay()===0+i&&t.getMonth()!==e.getMonth())break}}clearDateSelections(){this.selectedStartDate=null,this.selectedEndDate=null}navigateMonth(a){const e=new Date(this.displayedDate);this.displayedDate=new Date(e.getFullYear(),e.getMonth()+a,1).toISOString()}dateInputDateSet({detail:{date:a,input:e}}){const[t,i]=a.split("T"),[n,r,o]=t.split("-").map(Number);this.displayedDate=new Date(n,r-1,1).toString();const[l,u]=this.withInputs==="date-and-time"?i.split(":").map(Number):[];this._selectDate({day:o,month:r-1,year:n,hour:l,minute:u,input:e})}selectDate({detail:{date:a}}){a.type!=="day"?this.updateDisplayedHeader(a.type,a.day):this._selectDate({day:a.day})}hoverDate({detail:{date:a}}){const e=new Date(this.displayedDate);this.hoveredDate=new Date(e.getFullYear(),e.getMonth(),a.day)}mousedOutDate(){this.hoveredDate=null}selectMenuRow(a){const e=a.detail.menuSelection;if(!e)return;this.marketMenuSelectionChanged.emit({menuSelection:e});const t=this.selectedStartDate,i=this.selectedEndDate;this._setMenuRowOption(e),e!==d.CUSTOM&&this.marketDateRangeChanged.emit({prevStartDate:t,prevEndDate:i,startDate:this.selectedStartDate,endDate:this.selectedEndDate,menuSelection:e})}setInvalidState({detail:{invalid:a}}){this.invalid=a}_setMenuRowOption(a){const e=new Date;switch(a){case d.TODAY:this.clearDateSelections(),this.selectedStartDate=e.toISOString();break;case d.YESTERDAY:this.clearDateSelections(),this.selectedStartDate=P().toISOString();break;case d.THIS_WEEK:this.selectedStartDate=k(e).toISOString(),this.selectionType==="range"&&(this.selectedEndDate=E(e).toISOString());break;case d.LAST_WEEK:{const t=U(e,1);this.selectedStartDate=k(t).toISOString(),this.selectionType==="range"&&(this.selectedEndDate=E(t).toISOString());break}case d.THIS_MONTH:this.selectedStartDate=O(e).toISOString(),this.selectionType==="range"&&(this.selectedEndDate=M(e).toISOString());break;case d.LAST_MONTH:{const t=V(e,1);this.selectedStartDate=O(t).toISOString(),this.selectionType==="range"&&(this.selectedEndDate=M(t).toISOString());break}case d.THIS_YEAR:this.selectedStartDate=_(e).toISOString(),this.selectionType==="range"&&(this.selectedEndDate=I(e).toISOString());break;case d.LAST_YEAR:{const t=K(e,1);this.selectedStartDate=_(t).toISOString(),this.selectionType==="range"&&(this.selectedEndDate=I(t).toISOString());break}}a!==d.CUSTOM&&(this.displayedDate=this.selectedStartDate)}_selectDate(a){var e;const t=this.selectedStartDate,i=this.selectedEndDate,n=new Date(this.displayedDate),r=(e=a.month)!==null&&e!==void 0?e:n.getMonth(),o=new Date(a.year||n.getFullYear(),r,a.day||n.getDate(),a.hour||n.getHours(),a.minute||n.getMinutes()).toISOString();this.displayMenu&&!b(new Date(this.selectedStartDate),new Date(o))&&this.el.shadowRoot.querySelector(p("market-date-picker-menu"))._selectCustomRow(),this.selectionType==="single"?(this.clearDateSelections(),this.selectedStartDate=o):this.selectedStartDate&&!this.selectedEndDate&&o>=this.selectedStartDate?this.selectedEndDate=o:a.input?(a.input==="start"&&(this.selectedStartDate=o),a.input==="end"&&(this.selectedEndDate=o)):(this.clearDateSelections(),this.selectedStartDate=o),this.marketDateRangeChanged.emit({prevStartDate:t,prevEndDate:i,startDate:this.selectedStartDate,endDate:this.selectedEndDate,menuSelection:d.CUSTOM})}toggleCaret(){this.yearViewActive=!this.yearViewActive}validateDisplayedDate(a){new Date(a).toString()==="Invalid Date"&&(this.displayedDate=new Date().toISOString())}buildInitialYearView(){this.validateDisplayedDate(this.displayedDate);const e=new Date(this.displayedDate).getFullYear();this.yearViewYearsList=[(e-1).toString(),e.toString(),(e+1).toString()];for(let t=0;t<12;t++){const i=new Date(2024,t).toLocaleDateString(this.locale,{month:"short"});this.yearViewMonthList.push(i)}}updateDisplayedYearList(a){this.yearViewYearsList=this.yearViewYearsList.map(e=>(Number(e)+a).toString())}updateDisplayedHeader(a,e){var t;let i;if(a==="year"&&(i={year:e}),a==="month"){const u=new Date(`${e} 1`).toLocaleDateString(this.locale,{month:"numeric"});i={month:Number(u)-1},this.toggleCaret()}const n=new Date(this.displayedDate),r=(t=i==null?void 0:i.month)!==null&&t!==void 0?t:n.getMonth(),o=new Date(i.year||n.getFullYear(),r,1).toISOString();this.displayedDate=o}componentWillLoad(){this.presetMenuOption&&this._setMenuRowOption(this.presetMenuOption),this.buildInitialYearView(),this.datePickerLabel=`date-picker-label-${H()}`}componentWillRender(){this.displayedMonth=new Date(this.displayedDate).toLocaleString(this.locale,{month:"short",year:"numeric"}),this.buildWeekdays(),this.buildCalendar()}render(){const a=p("market-date-picker-menu"),e=p("market-date-picker-date"),t=p("market-date-picker-input-date"),i=p("market-button"),n=p("market-icon"),r=p("market-divider");return s(R,{key:"77f9567e52eddd34e21c175103c0c95d948c0e00",class:"market-date-picker"},this.displayMenu&&s("list-view",{key:"961c156667807caa6b91be6c5560258b2958fae5"},s(a,{key:"5ddacda4bbba2e743d1708093cb2439394a56337",timeframe:this.timeframe,excludeMenuItems:this.excludeMenuItems,presetMenuOption:this.presetMenuOption},s("slot",{key:"05d71468d9a02eca4c67e01051b24a9cba1b2290",name:d.TODAY,slot:d.TODAY},"Today"),s("slot",{key:"1855d6cd569286cde368d24e42c33d840d9b05c8",name:d.YESTERDAY,slot:d.YESTERDAY},"Yesterday"),s("slot",{key:"473bd9db3c78191d5c48f6be6034dd0a0af5928b",name:d.THIS_WEEK,slot:d.THIS_WEEK},"This week"),s("slot",{key:"5319fd122e54d45277eadd60d30f2aa8194ee58f",name:d.LAST_WEEK,slot:d.LAST_WEEK},"Last week"),s("slot",{key:"61f9b6058d60c39e2ae9201910b059ed141c9b60",name:d.THIS_MONTH,slot:d.THIS_MONTH},"This month"),s("slot",{key:"65336398a132945faf6ac31aa71413330eba61c9",name:d.LAST_MONTH,slot:d.LAST_MONTH},"Last month"),s("slot",{key:"0fdd2a7d84ebafab15fe87e2d8db693107897b86",name:d.THIS_YEAR,slot:d.THIS_YEAR},"This year"),s("slot",{key:"ed42a1bee928cbc587e147972c2aba5faa029ab8",name:d.LAST_YEAR,slot:d.LAST_YEAR},"Last year"),s("slot",{key:"e1ce531e7595c0b1ea6ebe2cddaadea92dbb7d4d",name:d.CUSTOM,slot:d.CUSTOM},"Custom"))),s("calendar",{key:"a6297b07ce109f721347ff99a146090f3d0cb888"},s("header",{key:"879f997ce7284cbe15125ef222a531a75ef1c2d9"},s("nav",{key:"3fa071d7c415a1a846bb67627122703b2bb2eddd"},!this.yearViewActive&&s(i,{key:"6e4f042e19ff27a6796523a7043f2bb53ed3a069",class:"left-nav",size:"small","aria-label":"Previous month",onClick:()=>this.navigateMonth(-1)},s(n,{key:"624599aaae190a6a557d2ac6171839e3154e2ba3",slot:"icon",name:"arrow-left"})),s(i,{key:"277989688a8380916525d95523383970e9b7f802",class:"year-view-button","aria-label":"Toggle year view",onClick:()=>this.toggleCaret(),caret:this.yearViewActive?"up":"down",rank:"tertiary"},s("h2",{key:"5484ce9a38b3cafa7cc2e0ab56eba33314597e66",id:this.datePickerLabel},this.displayedMonth)),!this.yearViewActive&&s(i,{key:"db12aae8b5bfcd0a93816818e6e8d359b336d403",size:"small","aria-label":"Next month",onClick:()=>this.navigateMonth(1)},s(n,{key:"ee8e06797d1d20229a93deb5e497156c26fe3f10",slot:"icon",name:"arrow-right"})))),!this.yearViewActive&&s("month-view",{key:"76e69ec0c6cfd6644ecfeb52d5b516397bdb1778",role:"grid","aria-labelledby":this.datePickerLabel},this.displayedWeekdays.map(c=>s(e,{class:"weekday-header",disabled:!0,day:c})),this.days.map(c=>s(e,{disabled:c.disabled,selection:c.selection,today:c.today,selected:c.selected,day:c.date||null,type:"day"}))),this.yearViewActive&&s("year-view",{key:"39eda3dc055dff3147ebe91bf247fdc7c5fcf008","aria-labelledby":this.datePickerLabel},s("year-section",{key:"1690b00c84aab98ae5140842b4a83836fb381f66"},s(i,{key:"8e9e57f70ea91738336441643a8d73a70ca1a521",size:"small",rank:"tertiary","aria-label":"Previous year",onClick:()=>this.updateDisplayedYearList(-1)},s(n,{key:"0167d04cf396921e3137dd10dc247d42c002a9c0",slot:"icon",name:"chevron-left"})),this.yearViewYearsList.map(c=>s(e,{day:c,type:"year"})),s(i,{key:"a8dfc12a898ed9b06e6573e9a925e7296ea958f9",size:"small",rank:"tertiary","aria-label":"Next year",onClick:()=>this.updateDisplayedYearList(1)},s(n,{key:"5cdbab9d66252e7db18c31992aaf103c02a36a68",slot:"icon",name:"chevron-right"}))),s(r,{key:"941afe5a366ae3dd20aaacf07185b8385692c642",size:"thin"}),s("month-section",{key:"719fe80d0dc9e2e1232c6b74fdde1c77264ac005",role:"grid"},this.yearViewMonthList.map(c=>s(e,{day:c,type:"month"})))),this.withInputs&&s(t,{key:"bb40e40413ca51a557c03f82aaf650f0a45b517b",class:"date-input-top-margin",range:this.selectionType==="range",isDateDisabled:this.isDateDisabled,selectedStartDate:this.selectedStartDate,selectedEndDate:this.selectedEndDate,withTime:this.withInputs==="date-and-time",timeframe:this.timeframe},s("slot",{key:"2b05b82ec3036d094445f7d0c2d84b66131c65dc",name:"start-date",slot:"start-date"},this.selectionType==="range"?"Start ":"","Date"),s("slot",{key:"51387ef99665df0c4961c02578c5503b533a859e",name:"end-date",slot:"end-date"},"End Date"),s("slot",{key:"84afa4a30607d491ba2153705e59365b9c95f5ad",name:"start-time",slot:"start-time"},this.selectionType==="range"?"Start ":"","Time"),s("slot",{key:"2a458979b757e219e536eae7188f655d00af029b",name:"end-time",slot:"end-time"},"End Time"),s("slot",{key:"c946b3878076e43b1728c5abd8d413736686bd37",name:"range-error",slot:"range-error"},"Enter a valid date range"))))}get el(){return L(this)}static get watchers(){return{displayedDate:["validateDisplayedDate"]}}};X.style=$;export{X as market_date_picker};
