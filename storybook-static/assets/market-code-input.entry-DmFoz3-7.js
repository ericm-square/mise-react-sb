import{r,c as n,h as i,H as d,g as h}from"./preview-BLkU8-7b.js";import"./jsx-runtime-qGIIFXMu.js";import"./index-CDs2tPxN.js";import"./iframe-BYgjunmg.js";import"../sb-preview/runtime.js";import"./tslib.es6-pJfR_DrR.js";const c=`:host,::slotted(*),*{box-sizing:border-box}:host([disabled]){cursor:not-allowed !important;}:host([disabled]) *,:host([disabled]) ::slotted(*){cursor:not-allowed !important;pointer-events:none !important;}:host{position:relative;outline:none;font-weight:var(--field-input-weight);font-size:var(--field-input-size);line-height:var(--field-input-leading);cursor:text}:host input,:host ::slotted(input),:host textarea,:host ::slotted(textarea){width:100%;margin:0;padding:0;border:none;background-color:transparent;color:inherit;font-weight:inherit;font-size:inherit;font-family:inherit;line-height:inherit;letter-spacing:inherit;cursor:inherit}:host ::slotted(label){cursor:inherit}:host input:focus,:host ::slotted(input:focus),:host textarea:focus,:host ::slotted(textarea:focus){outline:none}:host input::-moz-placeholder,:host textarea::-moz-placeholder{color:var(--field-placeholder-text-color)}:host input::placeholder,:host textarea::placeholder{color:var(--field-placeholder-text-color)}:host ::slotted(input)::-moz-placeholder,:host ::slotted(textarea)::-moz-placeholder{color:var(--field-placeholder-text-color)}:host ::slotted(input)::placeholder,:host ::slotted(textarea)::placeholder{color:var(--field-placeholder-text-color)}:host([size='small']){font-size:var(--core-type-paragraph-20-size);line-height:var(--core-type-paragraph-20-leading)}:host{border-radius:var(--field-border-radius);background-color:var(--field-normal-state-background-color);color:var(--field-normal-state-input-color)}:host::after{content:"";position:absolute;inset:0;border-radius:var(--field-border-radius);box-shadow:inset 0 0 0 var(--field-border-size) var(--field-normal-state-normal-validity-border-color);pointer-events:none}:host([invalid])::after{box-shadow:inset 0 0 0 var(--field-border-size) var(--field-normal-state-invalid-validity-border-color)}:host(:hover){background-color:var(--field-hover-state-background-color);color:var(--field-hover-state-input-color)}:host(:hover)::after{box-shadow:inset 0 0 0 var(--field-border-size) var(--field-hover-state-normal-validity-border-color)}:host([invalid]:hover)::after{box-shadow:inset 0 0 0 var(--field-border-size) var(--field-hover-state-invalid-validity-border-color)}:host([focused]){color:var(--field-focus-state-input-color)}:host([focused])::after{box-shadow:inset 0 0 0 var(--field-focus-state-border-size)
        var(--field-focus-state-normal-validity-border-color)}:host([focused][invalid])::after{box-shadow:inset 0 0 0 var(--field-focus-state-border-size) var(--field-focus-state-invalid-validity-border-color)}:host([disabled]){background-color:var(--field-disabled-state-background-color) !important;color:var(--field-disabled-state-input-color) !important;cursor:not-allowed !important}:host([disabled])::after{box-shadow:inset 0 0 0 var(--field-border-size) var(--field-disabled-state-border-color) !important}:host([disabled]) ::slotted(.market-accessory),:host([disabled]) ::slotted(img[slot*="accessory"]),:host([disabled]) ::slotted(svg[slot*="accessory"]),:host([disabled]) ::slotted(div[slot*="accessory"]){--field-disabled-state-accessory-opacity:var(--row-disabled-state-leading-accessory-opacity);opacity:var(--field-disabled-state-accessory-opacity)}:host([value=""]) ::slotted(label){color:var(--field-normal-state-empty-phase-label-color)}:host(:not([value=""])) ::slotted(label),:host([value=""][autofilled]) ::slotted(label){color:var(--field-normal-state-float-phase-label-color)}:host(:hover) ::slotted(label){color:var(--field-hover-state-empty-phase-label-color)}:host(:not([value=""]):hover) ::slotted(label),:host([value=""][autofilled]:hover) ::slotted(label){color:var(--field-hover-state-float-phase-label-color)}:host([focused]) ::slotted(label){color:var(--field-focus-state-float-phase-label-color)}:host([value=""][disabled]) ::slotted(label){color:var(--field-disabled-state-empty-phase-label-color)}:host(:not([value=""])[disabled]) ::slotted(label),:host([value=""][autofilled][disabled]) ::slotted(label){color:var(--field-disabled-state-float-phase-label-color)}:host{display:flex;align-items:center;height:var(--input-code-height, 64px)}:host input{font-weight:var(--input-code-font-weight, var(--core-type-bold-weight));font-family:var(--core-type-mono-font-family, monospace);text-align:center}:host input:-webkit-autofill,:host input:-webkit-autofill:hover,:host input:-webkit-autofill:focus{box-shadow:0 0 0 calc(var(--input-code-height, 64px) / 2) var(--field-normal-state-background-color) inset}.code-input-container{display:flex;justify-content:center;width:100%;height:100%}.code-input-container::before,.code-input-container::after{content:"";flex-basis:100%;pointer-events:none}::slotted([slot="trailing-accessory"]){margin-right:var(--input-code-trailing-accessory-spacing, 12px)}input::-moz-placeholder{color:var(--input-code-placeholder-color, var(--core-fill-30-color));font-size:var(--input-code-placeholder-font-size, 24px)}input::placeholder{color:var(--input-code-placeholder-color, var(--core-fill-30-color));font-size:var(--input-code-placeholder-font-size, 24px)}`,u=c,p=class{constructor(e){r(this,e),this.marketCodeInputValueChange=n(this,"marketCodeInputValueChange",7),this.type="number",this.name=void 0,this.length=4,this.focused=!1,this.value="",this.readonly=!1,this.invalid=!1,this.disabled=!1,this._code=void 0}valueChangeHandler(e){const t=this.sanitizeValue(e);this.value!==t&&(this.value=t),this.setInputsFromValue(this.value)}setFocus(e=!0){var t;return this.focused=e,e?this.focusFirstEmptyInput():(t=this.el.shadowRoot.activeElement)===null||t===void 0||t.blur(),Promise.resolve()}isNumber(e){return/^\d+$/.test(e)}isValidChar(e){return/\s/.test(e)?!1:["text","password"].includes(this.type)||this.isNumber(e)}focusFirstEmptyInput(){const e=this.el.shadowRoot.querySelectorAll("input");let t;e.forEach(o=>{!o.value&&!t&&(t=o)}),t||(t=e[this.length-1]),t.focus()}initCode(e){if(e)if(this._code=e.split(""),this._code.length<this.length){const t=Array.from({length:this.length-this._code.length}).fill("");this._code=[...this._code,...t]}else this._code.length>this.length&&(this._code=this._code.slice(0,this.length));else this._code=Array.from({length:this.length}).fill("")}sanitizeValue(e){return e.split("").filter(t=>this.isValidChar(t)).join("").slice(0,this.length)}getValueFromInputs(){let e="";return this.el.shadowRoot.querySelectorAll("input").forEach(t=>{e+=t.value}),e}setInputsFromValue(e){this.el.shadowRoot.querySelectorAll("input").forEach((o,l)=>{const s=e[l],a=e[l-1];o.value=s||"",l===0||a?o.removeAttribute("tabindex"):o.tabIndex=-1})}spreadChars(e){const{target:t,data:o}=e,l=o||t.value;if(!l)return;const s=this.sanitizeValue(l);s?this.insertChars(t,s.split("")):t.value=""}insertChars(e,t){const{nextElementSibling:o}=e,[l,...s]=t;e.value=l,o==null||o.focus(),o&&s.length>0&&this.insertChars(o,s)}updateValue(){const e=this.value,t=this.sanitizeValue(this.getValueFromInputs());if(e!==t){const{defaultPrevented:o}=this.marketCodeInputValueChange.emit({code:t});o?this.setInputsFromValue(e):this.value=t}}onInput(e){this.spreadChars(e),this.updateValue()}onFocus(e){const{target:t}=e;this.focused=!0,t.value?t.select():this.focusFirstEmptyInput()}onBlur(){this.focused=!1}onKeyDown(e){const{target:t,key:o}=e,{value:l,previousElementSibling:s,nextElementSibling:a}=t;switch(o){case"ArrowLeft":e.preventDefault(),s==null||s.select();break;case"ArrowRight":e.preventDefault(),a==null||a.select();break;case"Backspace":l||s==null||s.select();break}}onKeyUp(e){const{target:t}=e,{value:o}=t;o.length>1?this.spreadChars(e):this.isValidChar(o)||(t.value="",t.focus())}onHostClick(){this.el.shadowRoot.activeElement||this.setFocus()}componentWillLoad(){this.valueChangeHandler(this.value),this.initCode(this.value)}render(){const e=[];return this._code.forEach((t,o)=>{const l=this._code[o-1]||o===0?null:-1;e.push(i("input",{required:!0,type:this.type==="password"?"password":"text",inputmode:this.type==="number"?"numeric":null,autocomplete:o===0?"one-time-code":null,value:t,maxlength:o===this.length-1?"1":null,readOnly:this.readonly,disabled:this.disabled,placeholder:"●",tabindex:l,onFocus:s=>this.onFocus(s),onBlur:()=>this.onBlur(),onInput:s=>this.onInput(s),onKeyDown:s=>this.onKeyDown(s),onKeyUp:s=>this.onKeyUp(s)}))}),i(d,{key:"c11c05f9414698bd9d8f87b3e98adc021b233f1c",class:"market-code-input",name:this.name,onClick:()=>this.onHostClick()},i("span",{key:"d3b5a43bb80ee199628650c96e6f9b17cf8fee88",class:"code-input-container"},e),i("slot",{key:"8f0aa799fa46d759e6015488a07a2f6bb7c64669",name:"trailing-accessory"}))}get el(){return h(this)}static get watchers(){return{value:["valueChangeHandler"]}}};p.style=u;export{p as market_code_input};
