import{r as v,c as m,h as b,H as p,g as E}from"./preview-BLkU8-7b.js";import{g}from"./index-2dc281eb-DCayfYZh.js";import{R as w}from"./reorderable-ad24a486-D9uBLKy-.js";import{i as y}from"./draggable-3c5539a5-C1SC_K6H.js";import{s as k}from"./utils-1428aa72-Boutt1vS.js";import"./jsx-runtime-qGIIFXMu.js";import"./index-CDs2tPxN.js";import"./iframe-BYgjunmg.js";import"../sb-preview/runtime.js";import"./tslib.es6-pJfR_DrR.js";import"./raf-ac8923ee-Dje82vI4.js";import"./max-z-index-7a974719-43GcVZqA.js";import"./index-b9ae40c9-Bb5aO-kv.js";import"./index-33c9a13b-DS93TaAl.js";const S=':host,*{box-sizing:border-box}:host{--table-cell-state-normal-background-color:var(--core-surface-10-color);position:relative;display:block;overflow:auto;width:100%;background-color:var(--table-cell-state-normal-background-color);font-feature-settings:"tnum"}:host [role="table"]{display:table;vertical-align:middle;width:100%;height:100%;border-spacing:0;border-collapse:separate;table-layout:auto;text-align:left}:host slot{vertical-align:inherit;text-align:inherit}:host([layout="fixed"]) [role="table"]{table-layout:fixed}:host([align="left"]) [role="table"]{text-align:left}:host([align="center"]) [role="table"]{text-align:center}:host([align="right"]) [role="table"]{text-align:right}:host([valign="top"]) [role="table"]{vertical-align:top}:host([valign="middle"]) [role="table"]{vertical-align:middle}:host([valign="bottom"]) [role="table"]{vertical-align:bottom}::slotted(.market-drag-cursor){--drag-cursor-height:4px;position:absolute;right:0;left:0;display:block;height:0;outline:calc(var(--drag-cursor-height) / 2) solid var(--core-emphasis-fill-color);pointer-events:none}',C=S,x=class{constructor(e){v(this,e),this.marketTableV2RowsReordered=m(this,"marketTableV2RowsReordered",7),this.align=void 0,this.collapsible=!1,this.layout="auto",this.reorderable=void 0,this.reorderMode="default",this.selected="false",this.valign=void 0}async onMarketTableV2SelectionChange(e){const{header:t,footer:o}=this,{target:r,detail:a}=e,s=a.current;e.stopPropagation(),r===t||r===o?await this.setSelected(s,{silent:!0}):await this.setSelectedFromChildEvent(e)}onMarketTableV2CellSortClicked(e){const{el:t,header:o,children:r,groups:a,footer:s}=this,l=e.target;if(l.parentElement!==o)return;const{current:i}=e.detail,h=[...o.children],d=h.indexOf(l),{sortStrategy:n,sortStrategyFormat:f}=l,u=k({items:r,order:i,column:d,strategy:n,format:f});a==null||a.forEach(c=>{c.sort({order:i,column:d,strategy:n,format:f})}),l.sortOrder=i,h.forEach(c=>{c.sortOrder=c===l?i:void 0}),u.forEach(c=>{t.append(c)}),s&&t.append(s)}onDragMove(e){var t;(t=this.reorder)===null||t===void 0||t.dragMove(e)}onDragLeave(){var e;(e=this.reorder)===null||e===void 0||e.dragLeave()}onDragEnd(e){var t;(t=this.reorder)===null||t===void 0||t.dragEnd(e)}onDragDrop(e){var t;(t=this.reorder)===null||t===void 0||t.dragDrop(e)}watchCollapsible(){const{rows:e,groups:t,collapsible:o}=this;t.forEach(r=>{r.collapsible=o,r.indent=0}),e.forEach(r=>{r.header||r.footer||(r.indent=o&&t.length>0?1:0)})}watchReorderable(){const{el:e,reorder:t,reorderable:o,reorderMode:r,marketTableV2RowsReordered:a}=this;if(t==null||t.destroy(),["internal","external"].includes(o)){const l=g("market-table-v2-row"),i=g("market-table-v2-group");this.reorder=new w({el:e,accepts:[`${l}:not([header]):not([footer]):not([slot="parent"])`,i],event:a,mode:r})}this.syncDragEnabled()}async setSelected(e,{silent:t=!1}={}){const{header:o,footer:r,children:a,selected:s}=this;return s===e||(this.selected=e,await(o==null?void 0:o.setSelected(e,{silent:t})),await(r==null?void 0:r.setSelected(e,{silent:t})),a==null||a.forEach(async l=>{await l.setSelected(e,{silent:t})})),Promise.resolve()}async setSelectedFromChildEvent(e){const{header:t,footer:o,children:r,selected:a}=this,{target:s,detail:l}=e,{current:i}=l,h=r.map(n=>s===n?i:n.selected),d=h.every(n=>n==="true")?"true":h.every(n=>n==="false")?"false":"indeterminate";a!==d&&(this.selected=d,await(t==null?void 0:t.setSelected(d,{silent:!0})),await(o==null?void 0:o.setSelected(d,{silent:!0})))}getElements(){this.rows=[...this.el.children].filter(e=>e.tagName===g("market-table-v2-row").toUpperCase()),this.groups=[...this.el.children].filter(e=>e.tagName===g("market-table-v2-group").toUpperCase()),this.header=this.rows.find(e=>e.header),this.footer=this.rows.find(e=>e.footer),this.children=[...this.groups,...this.rows.filter(e=>!e.header&&!e.footer)]}syncDragEnabled(){const{header:e,footer:t,rows:o,groups:r,reorderable:a,reorderMode:s}=this,l=["internal","external"].includes(a);e&&(e.dragEnabled=l),t&&(t.dragEnabled=l),o==null||o.forEach(i=>{y(i)&&(i.dragEnabled=l)}),r==null||r.forEach(i=>{i.dragEnabled=l,i.reorderable=a,i.reorderMode=s})}onSlotChange(){this.getElements(),this.watchCollapsible(),this.syncDragEnabled()}connectedCallback(){this.getElements(),this.watchCollapsible(),this.syncDragEnabled()}componentDidRender(){this.watchReorderable()}render(){return b(p,{key:"ff6498a9a86efd1960cabf36309c62ccf2d7eef2",class:"market-table-v2"},b("div",{key:"2ab117eac57bd9dee4b2c6a7331442da85c6507d",role:"table",part:"table"},b("slot",{key:"935a77c47f8cb23cbc60e92b316f69ac8b8780b5",onSlotchange:()=>this.onSlotChange()})))}get el(){return E(this)}static get watchers(){return{collapsible:["watchCollapsible"],reorderable:["watchReorderable"]}}};x.style=C;export{x as market_table_v2};
